<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: Database</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: Database</h1>

    




<section>

<header>
    
        <h2><span class="attribs"><span class="type-signature"></span></span>Database<span class="signature">(data)</span><span class="type-signature"></span></h2>
        
            <div class="class-description"><p>Represents an SQLite database</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    
    <h4 class="name" id="Database"><span class="type-signature"></span>new Database<span class="signature">(data)</span><span class="type-signature"></span></h4>
    

    











    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>data</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;number></span>


            
            </td>

            

            

            <td class="description last"><p>An array of bytes representing
an SQLite database file</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line617">line 617</a>
    </li></ul></dd>
    

    

    

    
</dl>




















    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="%5B%22close%22%5D"><span class="type-signature"></span>["close"]<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Close the database, and all associated prepared statements.
The memory associated to the database and all associated statements
will be freed.</p>
<p><strong>Warning</strong>: A statement belonging to a database that has been closed
cannot be used anymore.</p>
<p>Databases <strong>must</strong> be closed when you're finished with them, or the
memory consumption will grow forever</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line873">line 873</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="%5B%22create_function%22%5D"><span class="type-signature"></span>["create_function"]<span class="signature">(name, func)</span><span class="type-signature"> &rarr; {<a href="Database.html">Database</a>}</span></h4>
    

    



<div class="description">
    <p>Register a custom function with SQLite</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>name</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>the name of the function as referenced in
SQL statements.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>func</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            

            

            <td class="description last"><p>the actual function to be executed.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line922">line 922</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The database object. Useful for method chaining</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Database.html">Database</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>Register a simple function
        db.create_function("addOne", function (x) {return x+1;})
        db.exec("SELECT addOne(1)") // = 2

    </code></pre>



        
            

    

    
    <h4 class="name" id="%5B%22each%22%5D"><span class="type-signature"></span>["each"]<span class="signature">(sql, params<span class="signature-attributes">opt</span>, callback, done)</span><span class="type-signature"> &rarr; {<a href="Database.html">Database</a>}</span></h4>
    

    



<div class="description">
    <p>Execute an sql statement, and call a callback for each row of result.</p>
<pre><code>Currently this method is synchronous, it will not return until the callback
has been called on every row of the result. But this might change.</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        
        <th>Default</th>
        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>sql</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>A string of SQL text. Can contain placeholders
that will be bound to the parameters given as the second argument</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Statement.html#.BindParams">Statement.BindParams</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            
                <td class="default">
                
                    []
                
                </td>
            

            <td class="description last"><p>Parameters to bind to the query</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>Function to call on each row of result</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>done</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            
                <td class="default">
                
                </td>
            

            <td class="description last"><p>A function that will be called when
all rows have been retrieved</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line803">line 803</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The database object. Useful for method chaining</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Database.html">Database</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
        <p class="code-caption">Read values from a table</p>
    
    <pre class="prettyprint"><code>    db.each("SELECT name,age FROM users WHERE age >= $majority", {$majority:18},
            function (row){console.log(row.name + " is a grown-up.")}
    );</code></pre>



        
            

    

    
    <h4 class="name" id="%5B%22exec%22%5D"><span class="type-signature"></span>["exec"]<span class="signature">(sql, params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {Array.&lt;<a href="Database.html#.QueryExecResult">Database.QueryExecResult</a>>}</span></h4>
    

    



<div class="description">
    <p>Execute an SQL query, and returns the result.</p>
<p>This is a wrapper against
Database.prepare,
Statement.bind,
Statement.step,
Statement.get,
and Statement.free.</p>
<p>The result is an array of result elements. There are as many result
elements as the number of statements in your sql string (statements are
separated by a semicolon)</p>
<h2>Example use</h2>
<p>We will create the following table, named <em>test</em> and query it with a
multi-line statement using params:</p>
<table>
<thead>
<tr>
<th style="text-align:center">id</th>
<th style="text-align:center">age</th>
<th style="text-align:center">name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">1</td>
<td style="text-align:center">Ling</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">18</td>
<td style="text-align:center">Paul</td>
</tr>
</tbody>
</table>
<p>We query it like that:</p>
<pre class="prettyprint source lang-javascript"><code>var db = new SQL.Database();
var res = db.exec(
    &quot;DROP TABLE IF EXISTS test;\n&quot;
    + &quot;CREATE TABLE test (id INTEGER, age INTEGER, name TEXT);&quot;
    + &quot;INSERT INTO test VALUES ($id1, :age1, @name1);&quot;
    + &quot;INSERT INTO test VALUES ($id2, :age2, @name2);&quot;
    + &quot;SELECT id FROM test;&quot;
    + &quot;SELECT age,name FROM test WHERE id=$id1&quot;,
    {
        &quot;$id1&quot;: 1, &quot;:age1&quot;: 1, &quot;@name1&quot;: &quot;Ling&quot;,
        &quot;$id2&quot;: 2, &quot;:age2&quot;: 18, &quot;@name2&quot;: &quot;Paul&quot;
    }
);
</code></pre>
<p><code>res</code> is now :</p>
<pre class="prettyprint source lang-javascript"><code>    [
        {&quot;columns&quot;:[&quot;id&quot;],&quot;values&quot;:[[1],[2]]},
        {&quot;columns&quot;:[&quot;age&quot;,&quot;name&quot;],&quot;values&quot;:[[1,&quot;Ling&quot;]]}
    ]
</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>sql</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>a string containing some SQL text to execute</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Statement.html#.BindParams">Statement.BindParams</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>When the SQL statement contains
placeholders, you can pass them in here. They will be bound to the statement
before it is executed. If you use the params argument as an array,
you <strong>cannot</strong> provide an sql string that contains several statements
(separated by <code>;</code>). This limitation does not apply to params as an object.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line731">line 731</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The results of each statement</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="Database.html#.QueryExecResult">Database.QueryExecResult</a>></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="%5B%22export%22%5D"><span class="type-signature"></span>["export"]<span class="signature">()</span><span class="type-signature"> &rarr; {Uint8Array}</span></h4>
    

    



<div class="description">
    <p>Exports the contents of the database to a binary array</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line850">line 850</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>An array of bytes of the SQLite3 database file</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Uint8Array</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="%5B%22getRowsModified%22%5D"><span class="type-signature"></span>["getRowsModified"]<span class="signature">()</span><span class="type-signature"> &rarr; {number}</span></h4>
    

    



<div class="description">
    <p>Returns the number of changed rows (modified, inserted or deleted)
by the latest completed INSERT, UPDATE or DELETE statement on the
database. Executing any other type of SQL statement does not modify
the value returned by this function.</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line908">line 908</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the number of rows modified</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">number</span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="%5B%22handleError%22%5D"><span class="type-signature"></span>["handleError"]<span class="signature">()</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    <p>Analyze a result code, return null if no error occured, and throw
an error with a descriptive message otherwise</p>
</div>













<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line892">line 892</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
            

    

    
    <h4 class="name" id="%5B%22prepare%22%5D"><span class="type-signature"></span>["prepare"]<span class="signature">(sql, params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Statement.html">Statement</a>}</span></h4>
    

    



<div class="description">
    <p>Prepare an SQL statement</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>sql</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>a string of SQL, that can contain placeholders
(<code>?</code>, <code>:VVV</code>, <code>:AAA</code>, <code>@AAA</code>)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Statement.html#.BindParams">Statement.BindParams</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>values to bind to placeholders</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line831">line 831</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Throws:</h5>

        

<dl>
    <dt>
        <div class="param-desc">
        <p>SQLite error</p>
        </div>
    </dt>
    <dd></dd>
    <dt>
        <dl>
            <dt>
                Type
            </dt>
            <dd>
                
<span class="param-type">String</span>


            </dd>
        </dl>
    </dt>
    <dd></dd>
</dl>


    


<h5>Returns:</h5>

        
<div class="param-desc">
    <p>the resulting statement</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Statement.html">Statement</a></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="%5B%22run%22%5D"><span class="type-signature"></span>["run"]<span class="signature">(sql, params<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="Database.html">Database</a>}</span></h4>
    

    



<div class="description">
    <p>Execute an SQL query, ignoring the rows it returns.</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>sql</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>a string containing some SQL text to execute</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>params</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="Statement.html#.BindParams">Statement.BindParams</a></span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"><p>When the SQL statement contains
placeholders, you can pass them in here. They will be bound to the statement
before it is executed. If you use the params argument, you <strong>cannot</strong>
provide an sql string that contains several statements (separated by <code>;</code>)</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line648">line 648</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    <p>The database object (useful for method chaining)</p>
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="Database.html">Database</a></span>


    </dd>
</dl>

    




    <h5>Example</h5>
    
    <pre class="prettyprint"><code>// Insert values in a table
    db.run(
        "INSERT INTO test VALUES (:age, :name)",
        { ':age' : 18, ':name' : 'John' }
    );

    </code></pre>



        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id=".QueryExecResult">QueryExecResult</h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>columns</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;string></span>


            
            </td>

            

            

            <td class="description last"><p>the name of the columns of the result
(as returned by Statement.getColumnNames)</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>values</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array.&lt;Array.&lt;<a href="Database.html#.SqlValue">Database.SqlValue</a>>></span>


            
            </td>

            

            

            <td class="description last"><p>one array per row, containing
the column values</p></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line665">line 665</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
                
<h4 class="name" id=".SqlValue">SqlValue</h4>






    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">string</span>
|

<span class="param-type">number</span>
|

<span class="param-type">null</span>
|

<span class="param-type">Uint8Array</span>


        </li>
    </ul>





<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="api.js.html">api.js</a>, <a href="api.js.html#line255">line 255</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-SqlJs.html">SqlJs</a></li></ul><h3>Classes</h3><ul><li><a href="Database.html">Database</a></li><li><a href="Statement.html">Statement</a></li></ul><h3>Global</h3><ul><li><a href="global.html#initSqlJs">initSqlJs</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Oct 18 2020 09:57:48 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>